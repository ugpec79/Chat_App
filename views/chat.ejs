<!DOCTYPE html>
<html>
    <head>
        <title>ChatRoom</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="/css/styles1.css">
        <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    </head>
    <body>
        <div class="container">
            <div class="inner-cont">
                <div class="sidebar">
                    <div class="sidecont">
                        <span class = "chat-head">Users Online</span>
                        <form action="#">
                            <input type="text" placeholder="ðŸ”ŽSearch" class="Search"> 
                        </form>
                       
                        <div class="chats">
                            
                        </div>
             
                    </div>
                </div>
                <div class="main-chat">
                    <div class="header">
                        <span style="padding:20px"><%=roomId%></span>
                      
                    </div>
                    <div class="main">
                        
                    </div>
                    <div class="footer">
                        <form class="type-here" id="chatting" action="">
                            <input id="message" class="type"type="text" placeholder="Type here">
                            <button style="background: none; border:0" type="submit"><i class="uil uil-message" style="font-size: larger" ></i></button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
        <script>
            var user="<%=userId%>";
            var room="<%=roomId%>";
        </script>
        <script>
            socket=io();
            users={}
            socket.emit("new-user",user,room);
            socket.on("room-joined",(user)=>{
                var out="";
                out+=`<div class='chat1 using'><i class='uil uil-user'></i><span>${user}</span></div>`
                var  userOnline=document.getElementsByClassName("chats")[0];
                userOnline.append(out);
                users[user]=out;
            });
            var messagesOn=document.getElementsByClassName("main")[0];
            document.getElementById("chatting").addEventListener('submit', function(e) {
                e.preventDefault();
                if (document.getElementById("message").value) {
                  socket.emit('message-send', document.getElementById("message").value);
                  var out2="";
                  out2+=`<div class="user-message"><div class="user-msg sb1"><div><span class="username">${user}</span></div><div><p class="user-text">${document.getElementById("message").value}</p></div><div><span class="user-time">20:08</span></div></div></div>`
                  messagesOn.append(out2);
                  document.getElementById("message").value = '';
                }
              });
            socket.on("rec-msg",(msg,user)=>{
                var out3="";
                out3+=`<div class="sender-message"> <div class="sender-msg sb2"><div><span class="sendername">${user}</span></div><div><p class="sender-text">${msg}</p></div><div><span class="sender-time">20:11</span></div></div></div>`;
                messagesOn.append(out3);
            });
            socket.on("user-rem",(user)=>{
                console.log(user);
            })
             
          
        </script>
    </body>
</html>